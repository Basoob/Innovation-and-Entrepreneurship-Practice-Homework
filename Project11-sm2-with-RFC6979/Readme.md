# SM2-with-RFC6979
## RFC6979介绍：
RFC 6979 是一种确定性签名算法，它被用于生成数字签名过程中的随机数。RFC 6979 的全称是 “Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)”。

在传统的数字签名过程中，需要使用一个随机数来计算签名。然而，随机数的生成必须具备高度的安全性和不可预测性，以防止对签名的破解。为了解决随机数生成的问题，RFC 6979 提出了一种确定性的方法，不再依赖于真正的随机数生成器，而是基于私钥和消息的哈希函数来生成一个确定性的随机数。即RFC 6979定义的Deterministic Random Bit Generator (DRBG)算法。
## SM2签名算法实现：

* 椭圆曲线参数选择：SM2使用的椭圆曲线方程为 y^2 = x^3 + ax + b，在实际应用中，选取一个特定的椭圆曲线方程和基点G，椭圆曲线上的点就成为公共参数。

* 密钥生成：根据椭圆曲线方程和选定的基点G，从一个选定的整数范围内选择一个随机数作为私钥，然后通过椭圆曲线的运算得到公钥。密钥生成过程保证了私钥是随机的，公钥可通过私钥和基点G计算得到，并且满足基于椭圆曲线离散对数难题的求解困难性。

* 签名生成：签名生成过程包括计算消息的哈希值、产生随机数、计算曲线点、计算和设置椭圆曲线方程中的参数等步骤。具体流程如下：
<br>-计算消息的哈希值。
<br>-选择一个随机数k，并计算曲线点(r, y) = kG。
<br>-将r转化为整数形式，计算e = Hash(m) mod n，其中m是消息的哈希值，n是椭圆曲线的阶。
<br>-计算s = (e + dr) mod n，其中d是私钥。
<br>-如果s等于0，则重新选择随机数k，并重新执行前面的步骤。
<br>-最终签名为(r, s)。<br>
* 签名验证：签名验证过程包括验证消息哈希、计算和设置椭圆曲线参数等步骤。具体流程如下：
<br>-对签名数据进行解析得到签名数据(r, s)。
<br>-对消息进行哈希计算，得到消息的哈希值e。
<br>-计算曲线点(R, y) = (sG + eP)。
<br>-如果(R mod n)等于r，则签名验证通过；否则，签名验证失败。


## 运行指导：
将文件夹内全部代码放入项目，直接运行sm2_RFC6979.py文件即可

## 代码主要函数说明：
generate_k()函数:<br>
使用RFC6979中的PRF（Pseudorandom Function）来生成一个整数k。
具体来说，代码中使用HMAC-SHA256作为PRF，并结合了私钥、消息和一些固定的字节（v和k）作为输入。通过在每次迭代中计算HMAC并根据结果进行下一轮迭代，最终得到一个在指定范围内的整数k_int。

## 运行结果：
![project11-1](https://github.com/Basoob/Innovation-and-Entrepreneurship-Practice-Homework/assets/141385265/f1d3fa8c-e075-40b1-b222-53ef45705295)
